<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <title>CMP 회원가입 페이지</title>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link type="text/css" rel="stylesheet" href="css/materialize.css"  media="screen,projection"/>
  <link type="text/css" rel="stylesheet" href="css/login.css"  media="screen,projection"/>
  <style> #CONTENTS{ min-height: 800px;}</style>

</head>

<body>


  <div class="container" id="CONTENTS">

    <center>
      <br>  <br>  <br>
    <div class = "card-large">

    <form id="FRM">
    <div class="row">
      <center><h4>SIGN UP</h4></center><br><br>

      <div class="input-field col s12">
        <!-- 로그인 메일 주소 입력 폼 -->
        <input id="EMAIL" placeholder="메일 주소를 입력하세요" type="email" class="validate">
        <label for="EMAIL" style="text-align : left">Email</label>
      </div>


      <div class="input-field col s12">
        <!-- 패스워드 입력 폼 -->
        <input id="PASSWORD" placeholder="비밀 번호를 입력하세요" type="password" class="validate">
        <label for="PASSWORD" style="text-align : left">Password</label>
      </div>

      <div class="input-field col s12">
        <!-- 이름 메일 주소 입력 폼 -->
        <input id="NAME" placeholder="이름을 입력하세요" type="text" class="validate">
        <label for="NAME" style="text-align : left">Name</label>
      </div>

      <div class="input-field col s12">
        <!--  인증코드 입력 폼 -->
        <input id="PINCODE" placeholder="학교 인증 코드를 입력하세요" type="text" class="validate">
        <label for="PINCODE" style="text-align : left">Pin Code</label>
      </div>

      <div class="input-field col s12">
        <!-- 로그인 버튼  -->
        <br><center><button id="BTN_SIGNUP" type="button" class="btn right green darken-3"> 회 원 가 입 하 기 </button></center>
      </div>

      <div class="input-field col s12">
        <br>
        <p class="text"><center><a href="login.html"> &nbsp;로그인 페이지로 돌아가기</a></center></p>
        <br>
      </div>

    </div> <!-- end of row div-->
   </form>
   </div> <!-- end card-content div -->
 </center>
  </div> <!-- end container div -->


<!-- /////////////////////////////////// javascript 스크립트 영역 /////////////////////////////////// -->


  <!--Import jQuery before materialize.js-->
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script type="text/javascript" src="js/materialize.min.js"></script>


  <!-- firebase SDK 링크 -->
  <script src="https://www.gstatic.com/firebasejs/3.2.1/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.2.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.2.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.2.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.2.1/firebase-storage.js"></script>
  <script src="fireinit.js"></script>

  <script type="text/javascript">

    var database = firebase.database();

    //uid 받기위해 회원가입 사용자 유저
    var cmp_user;

    $('#BTN_SIGNUP').click(function()
    {
      // 메일
      var email = $("#EMAIL").val();
      // 비밀번호
      var password = $("#PASSWORD").val();
      //유저 이름
      var name = $("#NAME").val();

      // 핀 코드(학교별 인증 코드)
      var pinCode = $("#PINCODE").val();

      //메일 회원가입에 성공했을 경우
      firebase.auth().createUserWithEmailAndPassword(email, password).then(
        function()
        {
              // 회원 정보 갱신 = 페이지 새로 고침
              alert("CMP 가입을 축하드립니다!");
              window.location.href="index.html?" + name + "?";

            }, function(error)
            {
                console.log(error);
                alert(error.message);
            });
            // 자동 로그인 성공으로 간주 = onAuthStateChanged() 가 동작함
            }).catch(function(error){
            //메일 회원 가입에 실패 했을 때
            alert(error.message);
            });
  </script>
</body>
<html>
